<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Kumar‚Äôs Curry Dash ‚Äì Z≈Çap przyprawy!</title>
  <meta name="description" content="Szybka gierka: poruszaj miskƒÖ i ≈Çap przyprawy. Masz 30 sekund ‚Äì ile punkt√≥w zdobƒôdziesz?" />
  <!-- TODO: Uzupe≈Çnij adres docelowy gry (production URL) i grafiki podglƒÖdu -->
  <!-- Open Graph dla ≈Çadnego podglƒÖdu w po≈õcie na Facebooku -->
  <meta property="og:title" content="Kumar‚Äôs Curry Dash ‚Äì Z≈Çap przyprawy!" />
  <meta property="og:description" content="Poruszaj miskƒÖ i ≈Çap przyprawy. Masz 30 sekund ‚Äì ile punkt√≥w zdobƒôdziesz?" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://twojadomena.pl/kumars-curry-dash" />
  <meta property="og:image" content="https://twojadomena.pl/kumars-curry-dash/og-image.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta name="twitter:card" content="summary_large_image" />
  <style>
    :root {
      --bg: #0f0f14;
      --fg: #fff7e6;
      --accent: #f4a261; /* curry */
      --accent2: #e76f51; /* chilli */
      --good: #2a9d8f; /* kolendra */
      --bad: #ef476f; /* cebula spalona ;) */
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; background: radial-gradient(1200px 800px at 50% 0%, #1a1a22, var(--bg)); color: var(--fg); font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji"; }
    .wrap { max-width: 720px; margin: 0 auto; padding: 16px; display: flex; flex-direction: column; gap: 12px; }
    header { text-align: center; }
    h1 { font-size: clamp(22px, 4vw, 32px); margin: 8px 0 0; }
    p { margin: 6px 0; opacity: .9; }

    .card { background: #16161d; border: 1px solid #262634; border-radius: 16px; padding: 12px; box-shadow: 0 10px 24px rgba(0,0,0,.25); }

    .hud { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 8px; }
    .hud .pill { background: #1f1f2a; border: 1px solid #2a2a3a; border-radius: 999px; padding: 8px 12px; text-align: center; font-weight: 600; }

    canvas { width: 100%; height: auto; background: linear-gradient(#201b16, #120e0a); border: 2px solid #3a2c1c; border-radius: 16px; display: block; }

    .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 10px; }
    button { appearance: none; border: 0; background: #242436; color: #fff; padding: 12px 14px; border-radius: 12px; font-weight: 700; cursor: pointer; border: 1px solid #33324a; }
    button:hover { filter: brightness(1.08); }
    .primary { background: linear-gradient(180deg, #ffb703, #fb8500); color: #3a2200; border-color: #9a5a00; }

    .footer { text-align: center; opacity: .7; font-size: 12px; margin-top: 6px; }

    .hidden { display: none !important; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div style="font-size: 13px; letter-spacing:.12em; text-transform: uppercase; opacity:.8">Kumar‚Äôs</div>
      <h1>Curry Dash ‚Äì z≈Çap przyprawy!</h1>
      <p>Stery: <strong>przesuwaj palcem</strong> lub <strong>strza≈Çki</strong>. Masz <strong>30 sekund</strong>. ≈Åap dobre sk≈Çadniki, unikaj spalonych!</p>
    </header>

    <div class="card">
      <div class="hud">
        <div class="pill">‚è±Ô∏è Czas: <span id="time">30</span>s</div>
        <div class="pill">‚≠ê Wynik: <span id="score">0</span></div>
        <div class="pill">üèÜ Rekord: <span id="best">0</span></div>
      </div>
      <canvas id="game" width="360" height="540" aria-label="Kumar's Curry Dash ‚Äì gra"></canvas>
      <div class="controls">
        <button id="btnStart" class="primary">‚ñ∂Ô∏è Start</button>
        <button id="btnShare">üì£ Udostƒôpnij wynik</button>
      </div>
      <div class="footer">Tip: dodaj aplikacjƒô do ekranu g≈Ç√≥wnego, by gra ≈Çadowa≈Ça siƒô szybciej.</div>
    </div>
  </div>

<script>
(() => {
  // Prosta, lekka gierka "z≈Çap spadajƒÖce" ‚Äì bez bibliotek.
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const hudTime = document.getElementById('time');
  const hudScore = document.getElementById('score');
  const hudBest = document.getElementById('best');
  const btnStart = document.getElementById('btnStart');
  const btnShare = document.getElementById('btnShare');

  const W = canvas.width;
  const H = canvas.height;

  // Rozgrywka
  const GAME_TIME = 30_000; // 30 sekund
  let state = 'idle';
  let startTs = 0;
  let score = 0;
  let best = Number(localStorage.getItem('kcd_best') || 0);
  hudBest.textContent = best;

  // Gracz ‚Äì miska na dole
  const player = { x: W/2, y: H-60, w: 64, h: 20, vx: 0 };

  // Obiekty spadajƒÖce
  const items = []; // {x,y,vy,type}
  const TYPES = [
    { name: 'kolendra', color: '#2a9d8f', value: +3 },
    { name: 'kurkuma',  color: '#f4a261', value: +2 },
    { name: 'chilli',   color: '#e76f51', value: +1 },
    { name: 'spalone',  color: '#ef476f', value: -3 }
  ];

  function resetGame() {
    score = 0;
    items.length = 0;
    player.x = W/2;
    player.vx = 0;
    hudScore.textContent = score;
    hudTime.textContent = Math.ceil(GAME_TIME/1000);
  }

  function spawnItem() {
    // Losuj rodzaj ‚Äì wiƒôksza szansa na dobre sk≈Çadniki (~80%)
    const r = Math.random();
    let t;
    if (r < 0.35) t = TYPES[1]; // kurkuma
    else if (r < 0.70) t = TYPES[2]; // chilli
    else if (r < 0.85) t = TYPES[0]; // kolendra
    else t = TYPES[3]; // spalone

    items.push({
      x: 20 + Math.random()*(W-40),
      y: -20,
      vy: 2 + Math.random()*2 + (elapsed()/10000), // lekki wzrost trudno≈õci
      type: t
    });
  }

  function elapsed() { return Date.now() - startTs; }

  // Rysowanie prostƒÖ grafikƒÖ
  function drawBackground() {
    // blat/kuchnia
    ctx.fillStyle = '#1b140e';
    ctx.fillRect(0,0,W,H);
    // p√≥≈Çki
    ctx.fillStyle = '#2a2017';
    for (let i=0;i<5;i++) {
      ctx.fillRect(0, 100+i*80, W, 2);
    }
  }

  function drawPlayer() {
    // miska ‚Äì elipsa
    ctx.fillStyle = '#ddb892';
    ctx.beginPath();
    ctx.ellipse(player.x, player.y, player.w/2, player.h/2, 0, 0, Math.PI*2);
    ctx.fill();
    // krawƒôd≈∫
    ctx.strokeStyle = '#b08968';
    ctx.lineWidth = 2;
    ctx.stroke();
  }

  function drawItem(it) {
    ctx.save();
    ctx.translate(it.x, it.y);
    ctx.fillStyle = it.type.color;
    // ma≈Ça przyprawa ‚Äì kapsu≈Çka
    ctx.beginPath();
    ctx.ellipse(0,0,10,14, 0, 0, Math.PI*2);
    ctx.fill();
    ctx.restore();
  }

  function intersects(ax, ay, aw, ah, bx, by, bw, bh) {
    return !(ax+aw < bx || ax > bx+bw || ay+ah < by || ay > by+bh);
  }

  // Sterowanie
  const keys = new Set();
  window.addEventListener('keydown', e => { if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') keys.add(e.key); });
  window.addEventListener('keyup', e => { keys.delete(e.key); });

  // Dotyk/gest przesuniƒôcia
  let touching = false;
  canvas.addEventListener('pointerdown', e => { touching = true; moveTo(e.offsetX); });
  canvas.addEventListener('pointermove', e => { if (touching) moveTo(e.offsetX); });
  window.addEventListener('pointerup', () => touching = false);

  function moveTo(x) { player.x = Math.max(player.w/2, Math.min(W - player.w/2, x)); }

  function update(dt) {
    // klawisze
    const speed = 240; // px/s
    if (keys.has('ArrowLeft')) player.x -= speed * dt;
    if (keys.has('ArrowRight')) player.x += speed * dt;
    player.x = Math.max(player.w/2, Math.min(W - player.w/2, player.x));

    // spawnowanie
    if (Math.random() < 0.03 + elapsed()/200000) spawnItem();

    // ruch obiekt√≥w
    for (let i = items.length - 1; i >= 0; i--) {
      const it = items[i];
      it.y += it.vy;
      if (intersects(player.x - player.w/2, player.y - player.h/2, player.w, player.h, it.x-10, it.y-14, 20, 28)) {
        score += it.type.value;
        if (score < 0) score = 0;
        hudScore.textContent = score;
        items.splice(i,1);
      } else if (it.y > H + 30) {
        items.splice(i,1);
      }
    }
  }

  // Pƒôtla gry
  let last = 0;
  function loop(ts) {
    if (state !== 'running') return; // pauza/koniec
    if (!last) last = ts;
    const dt = Math.min(0.033, (ts - last) / 1000); // max 33 ms
    last = ts;

    update(dt);

    // render
    ctx.clearRect(0,0,W,H);
    drawBackground();
    drawPlayer();
    for (const it of items) drawItem(it);

    // zegar
    const remaining = Math.max(0, GAME_TIME - elapsed());
    hudTime.textContent = Math.ceil(remaining/1000);

    if (remaining <= 0) {
      endGame();
      return;
    }

    requestAnimationFrame(loop);
  }

  function startGame() {
    resetGame();
    startTs = Date.now();
    state = 'running';
    last = 0;
    requestAnimationFrame(loop);
    btnStart.textContent = '‚è∏Ô∏è Pauza';
  }

  function pauseGame() {
    state = 'paused';
    btnStart.textContent = '‚ñ∂Ô∏è Wzn√≥w';
  }

  function resumeGame() {
    state = 'running';
    last = 0; // unikaj skoku czasu
    requestAnimationFrame(loop);
    btnStart.textContent = '‚è∏Ô∏è Pauza';
  }

  function endGame() {
    state = 'ended';
    if (score > best) {
      best = score;
      localStorage.setItem('kcd_best', String(best));
      hudBest.textContent = best;
    }
    btnStart.textContent = 'üîÅ Jeszcze raz';

    // Ekran ko≈Ñcowy ‚Äì lekki overlay
    ctx.fillStyle = 'rgba(0,0,0,.55)';
    ctx.fillRect(0,0,W,H);
    ctx.fillStyle = '#fff';
    ctx.font = 'bold 28px system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('Koniec czasu!', W/2, H/2 - 20);
    ctx.font = '22px system-ui, sans-serif';
    ctx.fillText(`Tw√≥j wynik: ${score}`, W/2, H/2 + 12);
    ctx.font = '16px system-ui, sans-serif';
    ctx.fillText('Kliknij ‚ñ∂Ô∏è aby zagraƒá ponownie', W/2, H/2 + 44);
  }

  btnStart.addEventListener('click', () => {
    if (state === 'idle' || state === 'ended') startGame();
    else if (state === 'running') pauseGame();
    else if (state === 'paused') resumeGame();
  });

  // Udostƒôpnianie wyniku
  btnShare.addEventListener('click', async () => {
    const url = new URL(window.location.href);
    url.searchParams.set('score', String(score));

    const shareText = `M√≥j wynik w Kumar‚Äôs Curry Dash: ${score} ‚≠ê\nWejd≈∫ i zagraj!`;

    if (navigator.share) {
      try {
        await navigator.share({ title: document.title, text: shareText, url: url.toString() });
        return;
      } catch {}
    }
    // Fallback: okno sharera Facebooka
    const fbUrl = new URL('https://www.facebook.com/sharer/sharer.php');
    fbUrl.searchParams.set('u', url.toString());
    fbUrl.searchParams.set('quote', shareText);
    window.open(fbUrl.toString(), '_blank');
  });

  // Je≈õli przyjdzie query ?autoplay=1 ‚Äì automatyczny start (np. w kampanii)
  if (new URLSearchParams(location.search).get('autoplay') === '1') startGame();
})();
</script>
</body>
</html>
